
<h1>Sign up now!</h1>

<form>
	<input type="text" id="firstname" name="firstname" placeholder="firstname">
	<input type="text" id="email" name="email" autocorrect="off" autocapitalize="off" data-initial="email@address.com" placeholder="email@domain.com">
	<button type="submit">Sign up</button>
</form>

<div id="result"></div>

<!--Load the customer.io tracker-->
<script type="text/javascript">
  var _cio = _cio || [];
  (function() {
    var a,b,c;a=function(f){return function(){_cio.push([f].
    concat(Array.prototype.slice.call(arguments,0)))}};b=["identify",
    "track"];for(c=0;c<b.length;c++){_cio[b[c]]=a(b[c])};
    var t = document.createElement('script'),
        s = document.getElementsByTagName('script')[0];
    t.async = true;
    t.id    = 'cio-tracker';
    t.setAttribute('data-site-id', '30860d08f0f6dd196dcc');
    t.src = 'http://mvp.dev/assets/track.js';
    s.parentNode.insertBefore(t, s);
  })();
</script>

<!--Load jquery-->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 

<!--Identify the user to customer.io-->

<script type="text/javascript">
	
	function addUserToCustomerIO(){
		var email = $("#email").val();
		var firstName = $("#firstname").val();

		_cio.identify({
    // Required Items
    id: email,
    email: email,
    created_at: new Date().getTime(), // seconds since the epoch

    // Optional (these are examples. You can name attributes what you wish)
    type: 'pre-launch',
		first_name: firstName,
		referrer: document.referrer
  });
	};

</script>

<!--Validate the form submission-->
<script type="text/javascript">
	function validateEmail(email) { 
		// http://stackoverflow.com/a/46181/11236
			var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
			return re.test(email);
	}

	function validate(){
		$("#result").text("");
		var email = $("#email").val();
		if (validateEmail(email)) {
			$("#result").text(email + " is valid :)");
			$("#result").css("color", "green");
			addUserToCustomerIO();
		} else {
			$("#result").text(email + "is not valid :(");
			$("#result").css("color", "red");
		}
		return false;
	}

	$("form").bind("submit", validate);

</script>
